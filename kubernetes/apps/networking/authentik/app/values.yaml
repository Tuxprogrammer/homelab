---
global:
  envFrom:
    - secretRef:
        name: authentik-env-secrets
  volumeMounts:
    # Mappings:
    # assets/flow_background.jpg -> /web/dist/assets/images/flow_background.jpg
    - name: custom-assets-flow-background-jpg
      mountPath: /web/dist/assets/images/flow_background.jpg
      subPath: flow_background.jpg
      readOnly: true
    # assets/base_full.html -> /authentik/core/templates/login/base_full.html
    - name: custom-assets-base-full-html
      mountPath: /authentik/core/templates/login/base_full.html
      subPath: base_full.html
      readOnly: true
    # assets/custom.css -> /web/dist/custom.css
    - name: custom-assets-custom-css
      mountPath: /web/dist/custom.css
      subPath: custom.css
      readOnly: true
    # assets/theme-dark.css -> /web/dist/theme-dark.css
    - name: custom-assets-theme-dark-css
      mountPath: /web/dist/theme-dark.css
      subPath: theme-dark.css
      readOnly: true
    # MontserratAlt1-Regular.ttf -> /web/dist/assets/fonts/montserratalt1/MontserratAlt1-Regular.ttf
    - name: custom-assets-montserrat-alt1-regular-ttf
      mountPath: /web/dist/assets/fonts/montserratalt1/MontserratAlt1-Regular.ttf
      subPath: MontserratAlt1-Regular.ttf
      readOnly: true
    # MontserratAlt1-Regular.woff -> /web/dist/assets/fonts/montserratalt1/MontserratAlt1-Regular.woff
    - name: custom-assets-montserrat-alt1-regular-woff
      mountPath: /web/dist/assets/fonts/montserratalt1/MontserratAlt1-Regular.woff
      subPath: MontserratAlt1-Regular.woff
      readOnly: true
    # MontserratAlt1-Regular.woff2 -> /web/dist/assets/fonts/montserratalt1/MontserratAlt1-Regular.woff2
    - name: custom-assets-montserrat-alt1-regular-woff2
      mountPath: /web/dist/assets/fonts/montserratalt1/MontserratAlt1-Regular.woff2
      subPath: MontserratAlt1-Regular.woff2
      readOnly: true

  volumes:
    - name: custom-assets
      configMap:
        name: authentik-assets

authentik:
  error_reporting:
    enabled: false
    send_pii: false
    environment: "nanabooboo"
  postgresql:
    enabled: true
server:
  autoscaling:
    enabled: true
    minReplicas: 1
    maxReplicas: 4
    targetCPUUtilizationPercentage: 50
  pdb:
    enabled: true
    minAvailable: 1
    maxUnavailable: 1
  ingress:
    enabled: true
    ingressClassName: "nginx"
    annotations:
      gethomepage.dev/enabled: "true"
      gethomepage.dev/group: Networking
      gethomepage.dev/name: Authentik
      gethomepage.dev/icon: authentik.png
      gethomepage.dev/pod-selector: app.kubernetes.io/name=authentik
      gethomepage.dev/widget.type: authentik
      gethomepage.dev/widget.url: http://authentik-server.networking.svc.cluster.local
      gethomepage.dev/widget.key: "{{HOMEPAGE_VAR_AUTHENTIK_TOKEN}}"
      external-dns.alpha.kubernetes.io/target: "ipv4.${SECRET_DOMAIN}"
    hosts: &hosts
      - "auth.${SECRET_DOMAIN}"
    tls:
      - hosts: *hosts

worker:
  autoscaling:
    enabled: true
    minReplicas: 1
    maxReplicas: 4
    targetCPUUtilizationPercentage: 50
  pdb:
    enabled: true
    minAvailable: 1
    maxUnavailable: 1

postgresql:
  enabled: true
  auth:
    existingSecret: "authentik-postgres-secrets"
  primary:
    persistence:
      enabled: true
      storageClass: "ceph-block-internal"
      size: 8Gi
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true

redis:
  enabled: true
  master:
    persistence:
      enabled: true
      storageClass: "ceph-block-internal"
      size: 8Gi
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
